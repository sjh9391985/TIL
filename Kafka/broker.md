### kafka broker

- 카프카가 설치되어 있는 서버 단위를 의미함.
- 3개이상의 브로커를 사용하는것을 권장.
- replication: 파티션의 복제를 의미함. (만약 replication이 1개라면 파티션이 1개라는 의미이며, 2개일 경우는 원본과 복제본 각각 1개씩 총 2개를 의미함.)
- 원본 한개의 파티션은 Leader 파티션이라고 부르며, 복제본 파티션은 Follower 파티션이라고 부름
- Leader와 Follower를 합쳐서 ISR(In Sync Replication) 이라고 부름

#### Replication 사용이유

- partition의 고가용성을 위해 사용됨.
- leader 파티션이 죽더라도 복제본인 follower 파티션이 존재하므로 복제본 복구가 가능함.
- 프로듀서가 토픽의 파티션에 데이터를 전달시 전달받는 주체가 leader 파티션
- 프로듀서에는 ack 라는 상세옵션이 존재함. 이 옵션은 replication 과 관련이 있음. (ack는 0, 1, all 3개의 옵션중에 하나의 옵션을 선택하여 설정가능)
- 0일 경우: Leader 파티션에 데이터를 전송, 응답값은 받지 않음. (leader 파티션에 데이터를 정상적으로 보냈는지, 잘 복제되었는지 알 수 없음.)
- 1일 경우: leader 파티션에 데이터를 전송, 응답값은 받음. 하지만 나머지 파티션이 복제가 되었는지 알 수 없음.(데이터 유실 가능성이 있음.)
- all일 경우: follower 파티션에 복제가 잘 되었는지 응답값을 받음. 리더 파티션에 데이터를 보낸 후, 팔로어 파티션에도 데이터가 저장되는 것을 확인하는 절차를 가짐. 0,1에 비해 확인하는 과정이 많기에 속도가 현저히 느리다는 단점이 있음.
